# Lefthook configuration
# https://github.com/evilmartians/lefthook

# Запускается перед коммитом
pre-commit:
  parallel: true
  commands:
    # Форматирование кода (все приложения)
    format:
      glob: "**/*.{js,jsx,ts,tsx,json,md,mdx,css}"
      run: pnpm format {staged_files}
      stage_fixed: true

# Запускается перед пушем
pre-push:
  parallel: false
  commands:
    # Проверка что билд проходит успешно
    build:
      run: pnpm frontend:build && pnpm api:build

# Commit message hook (опционально)
commit-msg:
  commands:
    # Проверка формата commit message
    # conventional:
    #   run: |
    #     message=$(cat {1})
    #     if ! echo "$message" | grep -qE "^(feat|fix|docs|style|refactor|perf|test|chore|build|ci|revert)(\(.+\))?: .+"; then
    #       echo "❌ Commit message must follow conventional commits format"
    #       echo "   Example: feat: add new feature"
    #       echo "   Types: feat, fix, docs, style, refactor, perf, test, chore, build, ci, revert"
    #       exit 1
    #     fi

# Skip hooks для экстренных случаев
# git commit --no-verify
# LEFTHOOK=0 git commit
